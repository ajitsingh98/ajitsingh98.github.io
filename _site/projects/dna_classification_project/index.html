<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/css/markdown-style.css">
    <title>DNA classification using Machine Learning</title>
</head>
<body>
    <header>
        <!-- <h1>DNA classification using Machine Learning</h1> -->
    </header>
    <main>
        <div id="project-content">
            <div id="loading-message" class="loading-message">
                <img src="/images/loading.gif" alt="Loading" class="loading-logo" />
                <p>Loading Projects...</p>
            </div>
            <a href="javascript:history.back()" class="back-button">‚Üê Back</a> <!-- Back button -->
            <div id="markdown-content" class="markdown-content">
                <!-- Content will be dynamically loaded here -->
            </div>
        </div>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const markdownUrl = "https://raw.githubusercontent.com/ajitsingh98/DNA-Classification-Machine-Learning-Project/master/README.md";
            const baseUrl = "https://github.com/ajitsingh98"; // e.g., "https://raw.githubusercontent.com"
            const projectName = "DNA-Classification-Machine-Learning-Project"; // e.g., "Evaluation-Metrics-In-Machine-Learning-Problems-Python"
            const branchName = "main"; // Adjust if your branch is different, like "master"
            const repoOwner = "ajitsingh98"
            const repoName = "DNA-Classification-Machine-Learning-Project"; // e.g., "All-About-Performance-Metrics"
            const repoApiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}`;

            // Fetch GitHub repository details for stars and forks
            async function fetchRepoDetails() {
                try {
                    const response = await fetch(repoApiUrl);
                    if (!response.ok) {
                        throw new Error('Failed to fetch repository details');
                    }
                    const repoData = await response.json();
                    const stars = repoData.stargazers_count;
                    const forks = repoData.forks_count;

                    // Display stars and forks below the markdown main heading
                    const statsContainer = document.createElement('div');
                    statsContainer.className = 'repo-stats';
                    statsContainer.innerHTML = `
                        <span>‚≠ê Stars: ${stars}</span> | 
                        <span>üç¥ Forks: ${forks}</span>
                    `;

                    // Insert repo stats below the first heading in markdown
                    const markdownContent = document.getElementById('markdown-content');
                    const firstHeading = markdownContent.querySelector('h1, h2, h3, h4, h5, h6'); // Adjust to insert after main heading
                    if (firstHeading) {
                        firstHeading.insertAdjacentElement('afterend', statsContainer);
                    }
                } catch (error) {
                    console.error('Error fetching repo details:', error);
                }
            }

            async function loadMarkdown(url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Failed to load markdown content');
                    }
                    const markdown = await response.text();
                    let renderedContent = marked.parse(markdown);

                    // Convert relative URLs to absolute URLs
                    const absoluteContent = renderedContent.replace(
                        /href="(?!http|https|\/)([^"]*)"/g, 
                        (match, relativePath) => {
                            // Convert the relative path to an absolute GitHub raw URL
                            return `href="${baseUrl}/${projectName}/blob/${branchName}/${relativePath}"`;
                        }
                    );

                    document.getElementById('markdown-content').innerHTML = absoluteContent;
                    if (window.MathJax) {
                        MathJax.typesetPromise();
                    }
                    document.getElementById('loading-message').style.display = 'none';
                    document.getElementById('markdown-content').style.display = 'block';

                    // Fetch and display repo details after content loads
                    fetchRepoDetails();
                } catch (error) {
                    console.error('Error fetching markdown:', error);
                    document.getElementById('markdown-content').textContent = 'Error loading content. Please refresh the page again...';
                }
            }

            // Load markdown content
            loadMarkdown(markdownUrl);
        });
    </script>    
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</body>
</html>
