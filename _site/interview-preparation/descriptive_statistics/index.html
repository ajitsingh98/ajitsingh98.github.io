<!-- _layouts/interview_layout.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/css/interview_preparation.css">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" async></script>
</head>
<body>
    <header>
        <button id="back-button" class="back-button" onclick="history.back()">‚Üê Back</button>
        <!-- <h1>Descriptive Statistics</h1> -->
    </header>

    <main>
        <div id="loading-message" class="loading-message">
            <img src="/images/loading.gif" alt="Loading" class="loading-logo" />
            <p>Preparing Interview Corner...</p>
        </div>
        <div id="markdown-content" class="markdown-content">
            <!-- Content will be dynamically loaded here -->
        </div>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const markdownUrl = "https://raw.githubusercontent.com/ajitsingh98/Data-Science-Interview-Questions-Answers/main/descriptive_statistics.md";
            const imageBaseUrl = "https://raw.githubusercontent.com/ajitsingh98/Data-Science-Interview-Questions-Answers/main/img/";

            async function loadMarkdown(url) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error('Failed to load markdown content');
                    }
                    const markdown = await response.text();
                    let renderedContent = marked.parse(markdown);

                    // Correct image paths by prepending the base URL
                    renderedContent = replaceImageUrls(renderedContent, imageBaseUrl);

                    // Set the modified HTML into the page
                    document.getElementById('markdown-content').innerHTML = renderedContent;

                    // Trigger MathJax to render LaTeX
                    if (window.MathJax) {
                        MathJax.typesetPromise();
                    }

                    // Hide the loading message
                    document.getElementById('loading-message').style.display = 'none';
                    document.getElementById('markdown-content').style.display = 'block';
                } catch (error) {
                    console.error('Error fetching markdown:', error);
                    document.getElementById('markdown-content').textContent = 'Error loading content. Please refresh the page again...';
                }
            }

            function replaceImageUrls(content, baseUrl) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = content;
                const images = tempDiv.querySelectorAll('img');
                images.forEach(img => {
                    const src = img.getAttribute('src');
                    if (src && !src.startsWith('http')) {
                        img.src = baseUrl + src.split('/').pop();
                    }
                });
                return tempDiv.innerHTML;
            }

            function setupInternalLinks() {
                document.querySelectorAll('#markdown-content a').forEach(anchor => {
                    anchor.addEventListener('click', function(event) {
                        event.preventDefault();
                        const href = this.getAttribute('href');
                        if (href.startsWith('#')) {
                            const targetElement = document.querySelector(href);
                            if (targetElement) {
                                targetElement.scrollIntoView({ behavior: 'smooth' });
                            }
                        }
                    });
                });
            }

            loadMarkdown(markdownUrl).then(setupInternalLinks);
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</body>
</html>
